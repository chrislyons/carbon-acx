import{c as g}from"./NewApp-BqazA668.js";/**
 * @license lucide-react v0.447.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const R=g("LoaderCircle",[["path",{d:"M21 12a9 9 0 1 1-6.219-8.56",key:"13zald"}]]),b="".trim(),x=(()=>{const t="/",e=t.startsWith("/")?t:`/${t}`,o=new URL("./api/",`http://localhost${e}`).pathname.replace(/\/?$/,"");return o.length>0?o:"/"})(),l=b.length>0?b:x;function $(t){if(/^https?:\/\//i.test(t))return t;const e=t.replace(/^\/+/,"");if(/^https?:\/\//i.test(l)){const c=l.endsWith("/")?l:`${l}/`;return new URL(e,c).toString()}const n=l.length>0?l:"/",o=n.startsWith("/")?n:`/${n}`,a=o.endsWith("/")?o:`${o}/`,s=new URL(a,"http://localhost"),i=new URL(e,s);return`${i.pathname}${i.search}${i.hash}`}async function d(t,e){const n=$(t),o=await fetch(n,e);if(!o.ok)throw new Error(`Request failed with status ${o.status}`);const a=o.headers.get("content-type"),s=await o.text();if(a&&a.toLowerCase().includes("application/json"))try{return JSON.parse(s)}catch(i){throw new Error(`Failed to parse JSON from ${n}: ${i.message}`)}try{return JSON.parse(s)}catch(i){const c=s.trim().slice(0,120),m=s.length>120?"â€¦":"";throw new Error(`Failed to parse JSON from ${n}: ${i.message}. Received: ${c}${m}`)}}function A(){return d("sectors.json").then(t=>t.sectors)}function j(){return d("datasets.json").then(t=>t.datasets)}function v(t){return y(t).then(e=>e.activities)}function y(t){return d(`sectors/${encodeURIComponent(t)}.json`).then(e=>({sector:e.sector,activities:e.activities,profiles:e.profiles??[]}))}function r(t){return typeof t=="string"?t:null}function f(t){if(typeof t=="number"&&Number.isFinite(t))return t;const e=typeof t=="string"?Number(t):Number.NaN;return Number.isFinite(e)?e:null}function _(t,e){if(!t||typeof t!="object")return null;const n=t,o=r(n.id)??`${e}`,a=r(n.label)??o,s=f(n.x),i=f(n.y),c=f(n.value);return s==null||i==null||c==null?null:{id:o,label:a,x:s,y:i,value:c,color:r(n.color),description:r(n.description)}}function U(t,e){if(!t||typeof t!="object")return e;const n=t,o=n.points??n.data;if(!Array.isArray(o))return e;const a=o.map((u,p)=>_(u,p)).filter(u=>!!u);if(a.length===0)return e;const s=(u,p)=>{if(!u||typeof u!="object")return{label:p,unit:null};const h=u;return{label:r(h.label)??p,unit:r(h.unit)}},i=s(n.xAxis??n.x_axis,"X value"),c=s(n.yAxis??n.y_axis,"Y value"),m=s(n.valueAxis??n.value_axis,"Bubble size");return{...e,figureType:"bubble",data:{id:e.figureId,title:e.title,subtitle:r(n.subtitle),description:e.description??r(n.description),xAxis:i,yAxis:c,valueAxis:m,points:a}}}function w(t){return Array.isArray(t)?t.map(e=>{if(!e||typeof e!="object")return null;const n=e,o=r(n.id)??r(n.figure_id),a=r(n.title)??"Untitled figure";if(!o)return null;const s={figureId:o,title:a,description:r(n.description),figureType:(r(n.type)??r(n.figure_type)??"unknown").toLowerCase(),data:n.data??null};return s.figureType.includes("bubble")?U(n.data,s):s}).filter(e=>!!e):[]}function S(t){const e=(t&&typeof t=="object"?t:{})??{},n=r(e.datasetId)??r(e.dataset_id)??r(e.id)??"",o=r(e.generatedAt)??r(e.generated_at),a=f(e.figureCount)??f(e.figure_count),s=r(e.manifestPath)??r(e.manifest_path),i=r(e.manifestSha256)??r(e.manifest_sha256);return{datasetId:n,generatedAt:o,figureCount:a,manifestPath:s,manifestSha256:i,title:r(e.title)??r(e.name),description:r(e.description),figures:w(e.figures)}}function I(t){if(!t||typeof t!="object")return{referenceId:"unknown",text:"Unknown reference"};const e=t,n=r(e.referenceId)??r(e.id)??"unknown";return{referenceId:n,text:r(e.text)??n,citation:r(e.citation),url:r(e.url),year:f(e.year),layer:r(e.layer)??void 0}}function N(t){return d(`datasets/${encodeURIComponent(t)}.json`).then(e=>({dataset:S(e.dataset),references:Array.isArray(e.references)?e.references.map(I):[]}))}function B(t){return d(`profiles/${encodeURIComponent(t)}.json`)}function C(){return d("emission-factors.json").then(t=>t.emissionFactors)}const F=Object.freeze(Object.defineProperty({__proto__:null,loadActivities:v,loadDataset:N,loadDatasets:j,loadEmissionFactors:C,loadProfileActivities:B,loadSector:y,loadSectors:A},Symbol.toStringTag,{value:"Module"}));export{R as L,C as a,j as b,v as c,F as d,A as l};
